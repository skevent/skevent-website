import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              */document.addEventListener("DOMContentLoaded",()=>{const g="https://script.google.com/macros/s/AKfycbxecJKDwbwI-HTfJpmah4hDWaRlI4s4AWFDzdmK8uwrIVOfVSm-XRAhRI9VZXW8Lwhb/exec",h=document.getElementById("loading-state"),u=document.getElementById("booking-card"),I=document.getElementById("back-link"),f=document.getElementById("booking-form"),c=document.getElementById("submit-btn"),y=document.getElementById("summary-title"),E=document.getElementById("summary-date"),k=document.getElementById("summary-location"),w=document.getElementById("summary-price"),p=document.getElementById("summary-total"),r=document.getElementById("tickets"),i=(()=>{const e=window.location.pathname.match(/\/book\/([a-zA-Z0-9-]+)/);return e?e[1]:null})();if(!i){alert("Invalid Booking URL"),window.location.href="/";return}const b="https://opensheet.elk.sh/1_7lOYKJZ_cmJeMn3hZNggNmk58Wu2SdYjVtlQgG-7lQ/upcoming_events";let l=null,s=0;fetch(b).then(t=>t.json()).then(t=>{l=t.find(e=>{const n=e.Type||e.type||"event",o=e.Date||e.date;let m=e.id||e.Id||e.ID;return!m&&n&&o&&(m=`${n.toLowerCase().trim()}-${o}`),m===i}),l?B(l):(alert("Event not found."),window.location.href="/")}).catch(t=>{console.error(t),alert("Error loading event data."),window.location.href="/"});function B(t){y.textContent=t.Title||t["Title "]||t.title;const e=new Date(t.Date||t.date);E.textContent=isNaN(e)?t.Date||t.date:e.toLocaleDateString("en-US",{weekday:"short",month:"long",day:"numeric",year:"numeric"}),k.textContent=t.Location||t.location||"Verify via details";const n=t.ticket_price||t["Ticket Price"]||t.price||"0";s=parseInt(n.toString().replace(/[^0-9]/g,""))||0,w.textContent=s>0?`₹${s}`:"Free",d(),L(),h.style.display="none",u.style.display="grid",setTimeout(()=>u.style.opacity="1",50)}function L(){I.href=`/events/${i}`}function d(){const e=(parseInt(r.value)||1)*s;p.textContent=e>0?`₹${e}`:"Free"}r.addEventListener("input",d),r.addEventListener("change",d),f.addEventListener("submit",async t=>{t.preventDefault();const e=parseInt(p.textContent.replace(/[^0-9]/g,""))||0;if(e<=0){alert("This event is free or has invalid pricing. Please contact support.");return}const n={action:"create_booking",name:document.getElementById("name").value,email:document.getElementById("email").value,phone:document.getElementById("phone").value,tickets:r.value,event_id:i,event_title:y.textContent,total_amount:e};c.textContent="Generating Secure Payment Link...",c.disabled=!0;try{const a=await(await fetch(g,{method:"POST",body:JSON.stringify(n)})).json();if(a.result==="success"&&a.payment_url)window.location.href=a.payment_url;else throw new Error(a.error||"Failed to generate payment link.")}catch(o){console.error("Booking Process Failed:",o),alert("Unable to initiate payment. Please check your connection or contact support. ("+o.message+")"),c.textContent="Proceed to Payment",c.disabled=!1}})});
